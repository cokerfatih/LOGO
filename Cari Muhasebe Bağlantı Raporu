ALTER VIEW DST_001_cariMUHBAGLANTI AS

SELECT 

               'Cari Hesap Kartları' AS MODUL,
               LG_001_CLCARD.CODE AS KOD,
			   CASE WHEN  LG_001_CLCARD.CCURRENCY=0 then 'TL' WHEN  LG_001_CLCARD.CCURRENCY=1 then 'USD' WHEN  LG_001_CLCARD.CCURRENCY=20 then 'EUR'   ELSE 'DİĞER' END [PARA BİRİMİ], 

               LG_001_CLCARD.DEFINITION_ AS AD,
			    LG_001_CLCARD.ADDR1 as ADRES,
				 LG_001_CLCARD.CITY as ŞEHİR,
				 LG_001_CLCARD.COUNTRY as ÜLKE,
               LG_001_CRDACREF.TYP,
			   LG_001_PAYPLANS.DEFINITION_ AS ÖDEME_PLANI,
			   LG_001_CLCARD.TAXNR AS VERGİNO,
			   LG_001_CLCARD.TAXOFFICE AS VERGİ_DAİRESİ,
			   lg_001_clcard.TCKNO as TCKN,
			   CASE WHEN  LG_001_CLCARD.CARDTYPE=1 then 'ALICI' WHEN  LG_001_CLCARD.CARDTYPE=2 then 'SATICI' WHEN  LG_001_CLCARD.CARDTYPE=3 then 'ALICI + SATICI'   ELSE 'DİĞER' END [KART TÜRÜ], 

               HESAP_TURU='Cari Hesap',
LG_001_EMUHACC.CODE AS [Muhasebe Hesabı Kodu],
LG_001_EMUHACC.DEFINITION_ AS [Muhasebe Hesabı Açıklaması]


FROM LG_001_CRDACREF LEFT JOIN
LG_001_CLCARD ON LG_001_CLCARD.LOGICALREF=LG_001_CRDACREF.cardref
left JOIN  LG_001_EMUHACC on LG_001_EMUHACC.LOGICALREF=LG_001_CRDACREF.ACCOUNTREF
left JOIN  LG_001_PAYPLANS on LG_001_PAYPLANS.LOGICALREF=LG_001_CLCARD.PAYMENTREF



--left JOIN  lg_001_EMCENTER on LG_001_EMCENTER.LOGICALREF=LG_001_CRDACREF.CENTERREF
WHERE LG_001_CRDACREF.TRCODE = '5'

