SELECT * FROM (SELECT
I.CARDTYPE "Malzeme Türü",
I.CODE "Malzeme Kodu",
I.NAME "Malzeme Adı",
I.SPECODE "Malzeme Özel Kodu",
I.CYPHCODE "Malzeme Yetki Kodu",
U.CODE "Birim Seti ",
T.CODE "Birim Kodu",
SUM(SIGN(L.IOCODE-1)*L.AMOUNT) "Satış Miktarı",
SUM(SIGN(4-L.IOCODE)*L.AMOUNT) "İade Miktarı",
SUM(SIGN(L.IOCODE-1)*L.TOTAL) "Satış Tutarı"
FROM
"LOGO_GO3"..LG_102_04_STLINE L
LEFT OUTER JOIN "ERCAGLAYAN_GO3"..LG_102_04_STFICHE F ON L.STFICHEREF=F.LOGICALREF
LEFT OUTER JOIN "ERCAGLAYAN_GO3"..LG_102_ITEMS I ON L.STOCKREF=I.LOGICALREF AND L.LINETYPE NOT IN (1,2,3,4)
LEFT OUTER JOIN "ERCAGLAYAN_GO3"..LG_102_UNITSETF U ON I.UNITSETREF=U.LOGICALREF
LEFT OUTER JOIN "ERCAGLAYAN_GO3"..LG_102_UNITSETL T ON U.LOGICALREF=T.UNITSETREF
WHERE
I.LOGICALREF IS NOT NULL
AND F.GRPCODE=2
AND T.LINENR=1
GROUP BY
I.CARDTYPE,
I.CODE,
I.NAME,
U.CODE,
T.CODE,
I.SPECODE,
I.CYPHCODE
) AS DYNMQRY
ORDER BY DYNMQRY.[Malzeme Kodu] ASC, DYNMQRY.[Malzeme Adı] ASC
